# Session API Request Examples

This directory contains example JSON requests for the Session API endpoints.

## Endpoint

All session requests should be sent to: `POST http://localhost:9000/session`

## Available Actions

### 1. Init Session
**File**: `init-session.json`

Initializes a new session for a user. This is typically called after successful user login.

**Required Args**:
- `userId` (string): The unique identifier of the user

**Example Request**:
```json
{
	"action": "init",
	"args": {
		"userId": "098be70d-f5c1-0799-e0b2-9226eb0c4f1d"
	}
}
```

**Example Response**:
```json
{
	"action": "init",
	"payload": {
		"sessionId": "0ca96562-89d9-8576-93b9-b5625fb0f039",
		"state": "ACTIVE",
		"loginTimestamp": "2025-01-01T12:00:00.000Z"
	}
}
```

---

### 2. Extend Session
**File**: `extend-session.json`

Extends the lifetime of an existing active session.

**Required Args**:
- `sessionId` (string): The unique identifier of the session to extend

**Example Request**:
```json
{
	"action": "extend",
	"args": {
		"sessionId": "0ca96562-89d9-8576-93b9-b5625fb0f039"
	}
}
```

**Example Response**:
```json
{
	"action": "extend",
	"payload": {
		"sessionId": "0ca96562-89d9-8576-93b9-b5625fb0f039",
		"state": "ACTIVE",
		"message": "Session extended successfully"
	}
}
```

---

### 3. Validate Session
**File**: `validate-session.json`

Validates whether a session is still active and valid.

**Required Args**:
- `sessionId` (string): The unique identifier of the session to validate

**Example Request**:
```json
{
	"action": "validate",
	"args": {
		"sessionId": "0ca96562-89d9-8576-93b9-b5625fb0f039"
	}
}
```

**Example Response (Valid Session)**:
```json
{
	"action": "validate",
	"payload": {
		"sessionId": "0ca96562-89d9-8576-93b9-b5625fb0f039",
		"state": "ACTIVE",
		"loginTimestamp": "2025-01-01T12:00:00.000Z"
	}
}
```

**Example Response (Invalid/Expired Session)**:
```json
{
	"action": "validate",
	"payload": {
		"sessionId": "0ca96562-89d9-8576-93b9-b5625fb0f039",
		"state": "EXPIRED"
	}
}
```

---

### 4. Terminate Session
**File**: `terminate-session.json`

Terminates (logs out) an active session.

**Required Args**:
- `sessionId` (string): The unique identifier of the session to terminate

**Example Request**:
```json
{
	"action": "terminate",
	"args": {
		"sessionId": "0ca96562-89d9-8576-93b9-b5625fb0f039"
	}
}
```

**Example Response**:
```json
{
	"action": "terminate",
	"payload": {
		"sessionId": "0ca96562-89d9-8576-93b9-b5625fb0f039",
		"message": "Session terminated successfully"
	}
}
```

---

## Error Responses

All endpoints may return error responses in the following format:

```json
{
	"action": "init",
	"error": "Error message here",
	"errorCode": 500
}
```

**Common Error Scenarios**:
- **Session service unavailable**: `"Session service is not available. Please try again later."`
- **Invalid session ID**: `"Session not found"` or `"Invalid session ID"`
- **Session expired**: `"Session has expired"`
- **Missing required arguments**: `"Missing required argument: sessionId"` or `"Missing required argument: userId"`

---

## Usage

### Using cURL

```bash
# Init session
curl -X POST http://localhost:9000/session \
  -H "Content-Type: application/json" \
  -d @request-examples/sessions/init-session.json

# Extend session
curl -X POST http://localhost:9000/session \
  -H "Content-Type: application/json" \
  -d @request-examples/sessions/extend-session.json

# Validate session
curl -X POST http://localhost:9000/session \
  -H "Content-Type: application/json" \
  -d @request-examples/sessions/validate-session.json

# Terminate session
curl -X POST http://localhost:9000/session \
  -H "Content-Type: application/json" \
  -d @request-examples/sessions/terminate-session.json
```

### Using JavaScript/TypeScript

```typescript
const response = await fetch('http://localhost:9000/session', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    action: 'init',
    args: {
      userId: '098be70d-f5c1-0799-e0b2-9226eb0c4f1d'
    }
  })
});

const data = await response.json();
console.log(data);
```

---

## Notes

- The session service runs on port 9200 by default (configured in `app.config.ts`)
- Sessions are managed by an external session-manager service
- Session IDs are UUIDs generated by the session service
- All timestamps are in ISO 8601 format
- Session state can be either `ACTIVE` or `EXPIRED`

